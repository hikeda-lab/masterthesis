\section{シミュレーション３}

MCMC法によるスパイクソーティングのパフォーマンスを調べた。
まず、MCMCによるスパイクソーティングのパフォーマンスがどの程度あるのかを調べるために、
スパイクの初期値をランダムに設定して
MCMC法によるスパイクソーティングのみでどれだけで、
どの程度のパフォーマンスを上げられるのか調べた。
スパイクの数は、シミュレーション２のデータを使って、データの最初の20個に限定して調べてみた。


\subsection{スパイクシミュレータの設定}
スパイクシミュレータの設定は、\ref{sec_simu_2}と同じものとした。
最初の２０個のスパイクのデータを使った。
各ニューロンのスパイクの数は
\begin{itemize}
 \item ニューロン１　12個　　
 \item ニューロン２　 7個  
 \item ニューロン３　 1個  
\end{itemize}
となった。
\subsection{MCMCの初期設定}

ニューロン1,2,3パラメータ$\delta,\lambda$の事前分布を一様分布で設定した。
$\delta_{1},\delta_{2},\delta_{3}$の事前分布の定義域を$0.1$から$0.9$とした。
また、
$\lambda_{1},\lambda_{2},\lambda_{3}$の事前分布を定義域を$1$から$200$とした。
\begin{eqnarray} 
\delta_{1},\delta_{2},\delta_{3} &\subset& u(0.1,0.8)  \\
\lambda_{1},\lambda_{2},\lambda_{3} &\subset& u(1,200)
\end{eqnarray}
初期値のパラメータの値を$\delta=0.5$,$\lambda=100.5$とした。
初期値のスパイラベル$C=\{C_{1},C_{2},\dots,C_{n}\}$
をランダムに設定した。
各スパイクのラベルの初期値がどのような番号に設定されたのかは、
\ref{tb:kekka_simu_3}に記した。

パラメータの候補分布には、酔歩過程\eqref{eq:randomwalk}をもちいて、$\tau$の値をそれぞれの定義
域の0.1倍とした。
スパイクラベルの候補には、現在と異なるラベルを等確率で候補として生成した。
各スパイクラベルについて100回、各パラメータ
$\delta_{1},\delta_{2},\delta_{3},\lambda_{1},\lambda_{2},\lambda_{3}$
ついては各スパイクラベルを調べるごとに1
回、合計30000回、メトロポリス-ヘイスティングアルゴリズムのステップを反復した。
