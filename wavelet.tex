\section{ウェーブレット解析について}
\label{sec:wavelet}
この節を書くために、文献\cite{Daubsci_2003},\cite{Toda_2005}を参考にした。
\subsection{フーリエ変換とウェーブレット変換}
今回は、スパイク波形から特徴を抽出するためにウェーブレット変換という
手法を用いた。
ウェーブレット変換とは、信号の時間周波数解析の手法の一つである。
ウェーブレット変換を用いると、一次元の信号を周波数分解する事ができる。
信号の周波数解析の手法として有名なものには、フーリエ変換がある。
信号に対しフーリエ変換を用いる事により、信号を指数関数の和に分解し、
その信号にどれだけの周波数の波が含まれるのかを調べる事ができる。
フーリエ変換が指数関数の和として信号を分解するのに対し、ウェーブレット変換は、
ウェーブレット（小さい波）と呼ばれる特殊な関数の和で信号を分解する。
フーリエ変換とウェーブレット変換を数式にして見比べると以下のようになる。
（連続）フーリエ変換
\begin{equation}
 f(\omega)=\int_{\infty}^{- \infty}f(t)e^{-i\omega t} d\omega
\end{equation}
（連続）ウェーブレット変換
\begin{eqnarray}
 W(\omega) &=& \int_{\infty}^{- \infty}f(t) \psi_{a,b} (t) d\omega \\
 \psi_{a,b}(t) &=& \psi (\frac{t-b}{a}) 
\end{eqnarray}
フーリエ変換の基底関数は周期が連続した指数関数である。これに対し、ウェーブレット変換
の基底関数$\psi(x)$は、空間に局所的な関数である。
ウェーブレット関数はフーリエ変換の基底関数とは異なり、様々な種類のものがある。
今回は、Daubechiesの基底関数と呼ばれるウェーブレット関数をスパイクの特徴抽出に採用した。
Daubechiesの基底関数(\fgref{fig:Daubechies})は以下の性質を持つ、ウェーブレット関数である。
(1)コンパクトサポートを持つ(平たく言うと、一つの区間でのみ値をもち、他で
の値は0),(2)正規直交系。
性質(2)によって、ウェーブレット関数を用ると、多重解像度解析（\fgref{MRA}）
と呼ばれる離散ウェーブレット変換のアルゴリズムを使用できる。

\subsection{多重解像度解析}
以下は、離散ウェーブレット変換のアルゴリズムの一つである多重解像度解析（\fgref{MRA}）について説明
する。
多重解像度解析とは、信号処理的に言うと、解析する信号にローパスフィルタとバンドパスフィルタ（ハイパスフィルタ）をかけ、ローパスフィルタで取りだした低域成分にさらにローパスフィルタとバンドパスフィルタをかける、ということを繰り返すことによって、離散ウェーブレット変換を行うアルゴリズムである。
元の信号をlevel 0とし,フィルタをかけるごとに、信号をlevel -1, level
-2,$\dots$,と呼ぶ。データの要素数が$2^{x}$である信号は最大でlevel -xまで多重解像度解析を行う事ができる。

多重解像度解析では、ウェーブレット変換の基底関数であるウェーブレット関数 $\psi(x)$を、次のようにスケーリング関数 $\phi(x)$から構成する。

スケーリング関数
\begin{equation}
 \phi_{j,n}(t) = \sqrt{2}^{j} \phi(2^{j}t - n) 
\end{equation}
ウェーブレット関数
\begin{equation}
 \psi_{j,n}(t) = \sqrt{2}^{j} \psi(2^{j}t - n) 
\end{equation}


多重解像度解析を信号処理的に言うと、スケーリング関数がローパスフィルタ、ウェーブレット関
数がバンドパスフィルタ（ハイパスフィルタ）である。

ここで信号fは次のように$\phi(t)$で補完する事ができる。

\begin{eqnarray}
 f(t) = \sum_{m} c_{0,m} \phi (t-m)
\end{eqnarray}

level 0の信号の多重解像度解析の中身はこの$c_{0,m}$の列、
$\{ c_{0,0},c_{0,1},\dots c_{0,2^{x}} \}$
スケーリング関数とウェーブレット関数は次のツースケール数列と呼ばれる
$p_{n},q_{n}$に関して、ツースケール関係と呼ばれる関係
を満たす。

ツースケール数列$p_{n},q_{n}$は次のような数列である。
\begin{eqnarray}
 q_{n} &=& \left( -1\right)^{1-n} p_{1-n} \\
\sum_{n} p_{n} &=& 2 
\end{eqnarray}
このツースケール数列具体的な値は、ウェーブレット関数の作者によって公開されている。
ドベシーはカスケードアルゴリズムという方法で、ツースケール数列を求めた。
ツースケール数列は$\phi(t),\psi(t)$と、次のツースケール関係をみたす。
\begin{eqnarray}
 \phi(t) &=& \sum_{n} p_{n} \phi(2t - n) \\
 \psi(t) &=& \sum_{n} q_{n} \phi(2t - n) 
\end{eqnarray}


このツースケール数列から、次の分解数列$h_{0}[n],h_{1}[n]$が
\begin{eqnarray} 
h_{0}[n] &=& \frac{1}{\sqrt{2}} \Bar p_{-n} \\
h_{1}[n] &=& \frac{1}{\sqrt{2}} \Bar p_{-n} 
\end{eqnarray}
と定義され、分解数列$h_{0}[n],h_{1}[n]$を用いる事によって次の
分解アルゴリズム
\begin{eqnarray}
 c_{j-1,n} &=& \sum_{m} h_{0}[2n-m] c_{j,m} \\
 d_{j-1,n} &=& \sum_{m} h_{1}[2n-m] c_{j,m}
\end{eqnarray}
が計算できる。分解アルゴリズムから計算した、ウェーブレット係数$d_{-1,n},d_{-2,n} \dots ,d_{-j,n}$とスケーリング関数係数$c_{-j,n}$がLevel-jで多重解像度解析した後の信号のデータの中身である。

\section{k-means法}
\label{sec:k-means}
分類するデータをn個とし、$\mathbf{x}_{i}(i=0 \sim n)$とする。 
各データはj次元とし、$\mathbf{x}_{i} = (x_{0},x_{1},\dots,x_{j-1})$とする。
クラスターの数をk個とする。
データ間の距離を定義する。データの全ての点を、有限個の代表点と距離に基づいて、最も近い点を集め
て作った領域をVoronoi領域という。
\par
k-menas法の手順は、次のようになる。
\begin{quote}
\begin{enumerate}
 \item 各データの中から、k個の代表ベクトルをランダムに選んで初期値とする。
 \item 代表ベクトルのVoronoi領域を求め、各Voronoi領域の平均値を計算する。
       平均値に一番近いデータを新しい代表ベクトルとする。
 \item 代表ベクトルが収束するまで、(2)を繰り返す。
\end{enumerate}
\end{quote}
